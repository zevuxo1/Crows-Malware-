// Helper Function
UINT32 HashStringRotr32Sub(UINT32 Value, UINT Count) {
    DWORD Mask = (CHAR_BIT * sizeof(value) - 1);
    Count &= Mask;
#PRAGMA WARNING( push )
#PRAGMA WARNING( disable : 4146 )
    return (Value >> Count | (Value << (( -Count ) & Mask);
#PRAGMA WARNING( pop )
}

// Actual Hash Function
INT HashStringRotr32ASCII(IN PCHAR str) {
    INT Value = 0;
    FOR (INT Index = 0; Index < lstrlenA(str); Index++) {
        Value = String[Index] + HashStringRotr32Sub(Value, INTIAL_SEED);
    } 
    return Value;
}

INT HashStringRotr32WIDE(IN PCHAR str) {
    INT Value = 0;
    FOR (INT Index = 0; Index < lstrlenW(str); Index++) {
        Value = String[Index] + HashStringRotr32Sub(Value, INTIAL_SEED);
    } 
    return Value;
}



