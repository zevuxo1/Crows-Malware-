#include "header.h"
#include "resource.h"

BOOL rcEnc(IN PBYTE pky, IN PBYTE pSc, IN DWORD pRks, IN DWORD pSs) {
	NTSTATUS STATUS = NULL;


	// Make to USTRING  Varibales
	// One is passed as Key and Other Passed As Payload to encrypt/decrypt
	USTRING key = { .Buffer = pky, .Length = pRks, .MaximumLength = pRks },
		data = { .Buffer = pSc, .Length = pSs, .MaximumLength = pSs };

	// Load Needed DLL since SystemFunction32 Is Exported From it
	fnSystemFunction032 pSystemFunction32 = (fnSystemFunction032)GetProcAddress(LoadLibraryA("Advapi32"), "SystemFunction032");
	if ((STATUS = pSystemFunction32(&data, &key)) != 0x0) {
		//("[!] Failed With Code: 0x%0.08", STATUS);
		return FALSE;
	}
	return TRUE;
}